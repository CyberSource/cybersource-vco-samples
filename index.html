<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="author" content="Bryan Carroll">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Visa Checkout</title>
  <script src="jquery-1.9.1.min.js"></script>
 
  
  <link rel="stylesheet" href="style-1.css">
  
  <!--*******************Begin onVisaCheckoutReady Function*******************-->
  <script type="text/javascript">
    function onVisaCheckoutReady() {
      V.init({
        apikey: apikey, //Change the apikey in script-1.js file 
        settings: {
          locale: "en_US",
          countryCode: "US",
          logoUrl: "http://demo.visacheckout.com/presidio/wp-content/uploads/2014/09/logo.png",
          displayName: "myStore",
          shipping: {
            acceptedRegions: ["US", "CA"],
            collectShipping: "true"
          },
          payment: {
            cardBrands: [
              "VISA",
              "MASTERCARD"],
            acceptCanadianVisaDebit: "true",
            billingCountries:["US","CA"]
          },
          review: {
            message: "Merchant defined message",
            buttonAction: "Continue"
          },
          dataLevel: "SUMMARY"
        },
        paymentRequest: {
          merchantRequestId: "Merchant defined request ID",
          currencyCode: "USD",
          subtotal: "10.00",
          shippingHandling: "2.00",
          tax: "2.00",
          discount: "1.00",
          giftWrap: "2.00",
          misc: "1.00",
          total: "25.00",
          description: "Megacorp Product",
          orderId: "Merchant defined order ID",
          promoCode: "Merchant defined promo code",
        },
        
        
      }
            );
      V.on("payment.success", function(payment){
        //Encrypted Payload is returned
        successFunction(payment); 
      });
      
      //Additional payment events
      //V.on("payment.cancel", function (payment){alert("You cancelled the checkout")});
      //V.on("payment.error", function (payment, error){alert("There was an error") });
  }
    
  </script>
  <!--*******************End onVisaCheckoutReady Function*********************-->

</head>
<body>
<div class="myContainer">
<h3>
  <u>Visa Checkout CyberSource Integration Sample</u>
</h3>
  <div id="visaButton">
    <p>
      <b>Step 1:</b> Add the button img tag, OnVisaCheckoutReady function and sdk.js visa checkout library.    
    </p>
    <!--********************** BEGIN Visa Checkout Button ************************-->
    <!--Visa Checkout Button img tag-->  
    <img alt="Visa Checkout" class="v-button" role="button" src="https://sandbox.secure.checkout.visa.com/wallet-services-web/xo/button.png?size=213"/>
 

    <!-- Visa Checkout sdk.js library -->  
    <script type="text/javascript" src="https://sandbox-assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js">
    </script>
    </div>   
  <!--*********************** End Visa Checkout Button ************************-->    
 
  <div id="encryptedData" style="display:none">
  <pre id="edata">
  </pre>
 </div>
  
  <!--Retrive Data: This will retrive the key peices of data from the Visa Checkout response payload-->
  <div id="visaRetriveCallID" style="display:none">
    <p>
      <b>Step 2:</b> Retrive the Call ID the payload. 
    </p>
    <input type="button" id="visaGetCallIDButton" value="CallID" />
    <pre id="CallIDResult" style="display:none">
    </pre>
  </div>
  
  <!-- Compile Cybersource Auth Messages: Populate the CyberSource request payloads with the appropriate data compiled above -->
  <div id="visaCYBSauth" style="display:none">
    <p>
      <b>Step 3:</b> Compile Cybersource Cybersource API Request
    </p>
    <input type="button" id="visaCYBSsoapButton" value="Generate SOAP payload" />
    <input type="button" id="visaCYBSsonvpButton" value="Generate Simple Order payload" />
    <input type="button" id="visaCYBSscmpnvpButton" value="Generate SCMP payload" />
    <pre id="resultAuth" style="display:none">
    </pre>
  </div>
</div>  
  
<!-- Do not alter -->  
<div class="vGuide">
  <p class="documentation">
    <a href="https://www.cybersource.com/developers/integration_methods/visa_checkout/" target="_blank">Documentation</a>
  </p>
  <p>
  Click on the "Remix" button, top right corner, and you can make changes to the code yourself. Save the changes you made by creating an account on thimble.mozilla.org. Refer to this link at any point, as the original code remains unchanged.
  </p>
</div>
  <script src="script-1.js" type="text/javascript"></script>

  
</body>
</html>
